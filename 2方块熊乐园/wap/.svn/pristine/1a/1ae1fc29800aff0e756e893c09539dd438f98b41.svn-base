lua_shared_dict infopub_themples 2m;
lua_shared_dict infopub_cdata 2m;
lua_shared_dict infopub_session 20m;

init_by_lua 'cjson = require "cjson"';
server {
    listen       80;
    listen       82;
    server_name  wap.lusaka.wxwenku.com wap.kalichimall.com;
    server_tokens off;
    more_set_headers 'Server: nginx';
    charset utf-8;

    chunked_transfer_encoding off;
    lua_code_cache off;

    set $base_dir  '/usr/local/openresty/nginx/html/lusaka/infopub';

    resolver 10.202.72.118;
    location / {
        default_type text/html;
        content_by_lua_file $base_dir/lua/index.lua;
    }
    
    location /yy {
        root html/lusaka;
    }
    
    location /ss {
        alias html/lusaka/WEB;
    }

    location /sa {
        alias html/lusaka;
    }
    
    location /s {
        default_type text/html;
        content_by_lua_file $base_dir/lua/search.lua;
    }

    location /reg {
		default_type text/html;
        content_by_lua_file $base_dir/lua/user_reg.lua;
    }

    location /login {
		default_type text/html;
        content_by_lua_file $base_dir/lua/user_login.lua;
    }
    
    location /pub {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/publish.lua;
    }
    
    location /spub {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/spublish.lua;
    }
    
    location /list {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/list.lua;
    }
	
	location /asmywish {
		default_type text/html;
		content_by_lua_file $base_dir/lua/asmywish.lua;
	}
	
	location /removewish {
		default_type text/html;
		content_by_lua_file $base_dir/lua/removewish.lua;
	}
    
    location /ulist {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/ulist.lua;
    }

    location /comments {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/comments.lua;
    }

    location /addcomment {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/addcomment.lua;
    }

    location /goodimages {
        default_type text/html;
        content_by_lua_file $base_dir/lua/goodimages.lua;
    }
    
    location /d {
    	default_type text/html;
        content_by_lua_file $base_dir/lua/details.lua;
    } 
    
    location /test {
    	default_type text/html;
    	content_by_lua_file $base_dir/lua/test.lua;
    }

    location /static {
        alias $base_dir/themples/default/static;
    }
    
}

server {
    listen       80;
    listen       82 default;
    server_name  lusaka.wxwenku.com www.kalichimall.com;
    server_tokens off;
    more_set_headers 'Server: nginx';
    charset utf-8;

    chunked_transfer_encoding off;
    lua_code_cache off;

    set $base_dir  '/usr/local/openresty/nginx/html/lusaka/infopub';

    resolver 10.202.72.118;
    location / {
        default_type text/html;
        root html/lusaka/WEB;
    }

    location /apigateway {
    	content_by_lua_file $base_dir/lua/api/gateway.lua;
    }

    location /gimg {
    	content_by_lua_file $base_dir/lua/api/getimg.lua;
    }

    location /tmpupdate {
        default_type text/html;
    	content_by_lua_file $base_dir/lua/api/tmpsvnupdate.lua;
    }

    location /static {
        alias $base_dir/themples/default/static;
    }
}
