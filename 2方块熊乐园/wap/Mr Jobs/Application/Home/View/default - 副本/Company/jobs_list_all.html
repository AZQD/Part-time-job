<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<include file="public:meta" />
		<link href="../public/css/company/common.css" rel="stylesheet" type="text/css" />
		<link href="../public/css/company/company_jobs.css" rel="stylesheet" type="text/css" />
		<link href="../public/css/company/company_ajax_dialog.css" rel="stylesheet" type="text/css" />
		<script src="../public/js/company/jquery.common.js" type="text/javascript" language="javascript"></script>
	</head>
	<body>
		<include file="index_header" />
		<div class="user_main">
			<div class="mleft">
				<include file="left_jobs" />
			</div>
			<div class="mright">
				<div class="user_pagetitle">
					<div class="pat_l"> Management positions </div>
					<div class="clear"></div>
				</div>
				<div class="user_tab mt15">
					<a href="{:U('company/jobs_list')}" class="tabli <if condition="$Think.get.type eq ''">select</if>"> All positions </a>
					<a href="{:U('company/jobs_list',array('type'=>1))}" class="tabli <if condition="$Think.get.type eq 1">select</if>"> Post position </a>
					<a href="{:U('company/jobs_list',array('type'=>2))}" class="tabli <if condition="$Think.get.type eq 2">select</if>"> Not shown </a>
					<div class="clear"></div>
					<if condition="$upper_limit eq 1">
					<div class="btnbox"><div class="btn_yellow J_hoverbut btn_add J_addJobsDig" href="javascript:;"> Post position </div></div>
					<else />
					<div class="btnbox"><div class="btn_yellow J_hoverbut btn_add" onclick="window.location='{:U('jobs_add')}'"> Post position </div></div>
					</if>
				</div>
				<div class="user_tip w680">
					<div class="tiptit"> hint </div>
					<div class="tiptxt link_blue">
					 Dear HR， Your account can be published at the same time  {$setmeal.jobs_meanwhile}  Position ， Is now available  {$total}  Position 。
					</div>
				</div>
				<notempty name="jobs_list['list']">
				<form id="form1" action="{:U('jobs_perform')}" class="J_allListBox" method="post">
					<div class="jobsWrap">
						<volist name="jobs_list['list']" id="jobs">
							<if condition="$jobs['display'] eq 2 || $jobs['_audit'] neq 1">
								<div class="jobsList">
									<div class="selWrap">
										<input name="y_id[]" class="selStatus J_allList" type="checkbox" value="{$jobs['id']}">
									</div>
									<div class="jobs fl">
										<div class="title">
											<a target="_blank" href="{$jobs.jobs_url}" class="">{$jobs.jobs_name}</a>
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$jobs.district_cn}
										</div>
										<div class="update">
											 Pending resume ：
											<a href="{:U('company/jobs_apply',array('jobs_id'=>$jobs['id'],'stop'=>1))}" class="">{$jobs.applys}</a>
											&nbsp;&nbsp; | &nbsp;&nbsp; Update time ：{:date('Y-m-d H:i',$jobs['refreshtime'])}
										</div>
									</div>
									<if condition="$jobs['_audit'] eq 2">
										<div class="status fl font_yellow"> under review </div>
									<elseif condition="$jobs['_audit'] eq 3" />
										<div class="status fl font_red"> The audit did not pass </div>
									<else />
										<div class="status fl font_red"> closed </div>
									</if>
									<div class="edit link_blue fl">
										<a href="{:U('company/jobs_edit',array('id'=>$jobs['id']))}" class=""> modify </a>
										<if condition="$jobs['_audit'] eq 1 && $jobs['display'] eq 2">
										<a href="javascript:;" url="{:U('jobs_display',array('y_id'=>$jobs['id'],'list_type'=>$_GET['type']))}" class="jobs_display"> restore </a>
										</if>
										<a href="javascript:;" url="{:U('jobs_delete',array('y_id'=>$jobs['id'],'list_type'=>$_GET['type']))}" class="delete"> delete </a>
									</div>
									<div class="clear"></div>
								</div>
							<else/>
								<div class="jobsList">
									<div class="selWrap">
										<input name="y_id[]" class="selStatus J_allList" type="checkbox" value="{$jobs['id']}">
									</div>
									<div class="jobs fl">
										<div class="title">
											<a target="_blank" href="{$jobs.jobs_url}" class="">{$jobs.jobs_name}</a>
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$jobs.district_cn}
										</div>
										<div class="update">
											 Pending resume ：
											<a href="{:U('company/jobs_apply',array('jobs_id'=>$jobs['id']))}" class="">{$jobs.applys}</a>
											&nbsp;&nbsp; | &nbsp;&nbsp; Update time ：{:date('Y-m-d H:i',$jobs['refreshtime'])}
											<a href="javascript:;" class="jobs_refresh" data-type="0" url="{:U('CompanyService/jobs_refresh',array('yid'=>$jobs['id']))}">[ Refresh ]</a>
										</div>
										<div class="J_operation btns">
											<a href="{:U('jobs_edit',array('id'=>$jobs['id']))}"> modify </a>
											<a href="{:url_rewrite('QS_resumelist',array('jobcategory'=>$jobs['jobcategory']))}"  target="_blank"> match </a>
											<if condition="$jobs['auto_refresh'] eq 1">
											<a href="javascript:;" class="for_hover">
												<font style="color:#999">智能 Refresh </font>
												<div class="des_box">
													<div class="desarrow"></div>
													<div class="des_txt">
														<!-- -->
														<strong> bought 【智能 Refresh 】 service </strong><br />
														 Effective time ：{$jobs['auto_refresh_starttime']}  to  {$jobs['auto_refresh_endtime']}
													</div>
												</div>
											</a>
											<else />
											<a href="javascript:;" class="jobs_refresh" data-type="1" url="{:U('CompanyService/jobs_refresh',array('yid'=>$jobs['id'],'increment'=>1))}">智能 Refresh </a>
											</if>
											<a href="javascript:;" url="{:U('jobs_close',array('y_id'=>$jobs['id'],'list_type'=>$_GET['type']))}" class="close"> shut down </a>
											<a href="javascript:;" url="{:U('jobs_delete',array('y_id'=>$jobs['id'],'list_type'=>$_GET['type']))}" class="delete"> delete </a>
											<a href="javascript:;" class="friend" url="{:urlencode(build_mobile_url(array('c'=>'Wzp','a'=>'com','params'=>'id='.$jobs["company_id"])))}"> Share a circle of friends </a>
										</div>
									</div>
									<div class="aloneOperation fl">
										<div class="box">
											<if condition="$jobs['stick']">
												<div class="for_hover">
													<div class="btn_lightgray J_hoverbut btn_inline_small btn_border mr10"> Positions </div>
													<div class="des_box">
														<div class="desarrow"></div>
														<div class="des_txt">
															<!-- -->
															<strong> bought 【 Positions 】 service </strong><br />
															 Effective time ：{:date('Y-m-d',$jobs['promotion']['stick']['starttime'])}  to  {:date('Y-m-d',$jobs['promotion']['stick']['endtime'])}
														</div>
													</div>
												</div>
												 Buy top promotion <i>{$jobs.promotion.stick.total_days}</i> day ， Remaining <i>{$jobs.promotion.stick.surplus}</i> day 
												<div class="clear"></div>
											<else/>
												<div class="btn_green J_hoverbut btn_inline_small mr10 stick_btn" data="{$jobs['id']}"> Positions </div>
												 Positions are always on top ，<i>{$promotion[0]['price']}</i> yuan /{$promotion[0]['value']} day 
											</if>
										</div>
										<div class="box borderTop">
											<if condition="$jobs['emergency']">
												<div class="for_hover">
													<div class="btn_lightgray J_hoverbut btn_inline_small btn_border mr10"> Emergency recruitment </div>
													<div class="des_box">
														<div class="desarrow"></div>
														<div class="des_txt">
															<!-- -->
															<strong> bought 【 Emergency recruitment 】 service </strong><br />
															 Effective time ：{:date('Y-m-d',$jobs['promotion']['emergency']['starttime'])}  to  {:date('Y-m-d',$jobs['promotion']['emergency']['endtime'])}
														</div>
													</div>
												</div>
												购买 Emergency recruitment <i>{$jobs.promotion.emergency.total_days}</i> day ， Remaining <i>{$jobs.promotion.emergency.surplus}</i> day 
											<else/>
												<div class="btn_yellow J_hoverbut btn_inline_small mr10 emergency_btn" data="{$jobs['id']}"> Emergency recruitment </div>
												 Emergency logo is more eye-catching ，<i>{$promotion[1]['price']}</i> yuan /{$promotion[1]['value']} day 
											</if>
										</div>
									</div>
									<div class="clear"></div>
								</div>
							</if>
						</volist>
					</div>
					<div class="jobsWrap">
						<div class="allSelWrap">
							<input name="" class="allSel J_allSelected" type="checkbox">
						</div>
						<div class="btn_lightgray J_hoverbut btn_inline btn_border" id="delete_all"> delete 职位</div>
						<div class="qspage">{$jobs_list.page}</div>
						<div class="clear"></div>
					</div>
				</form>
				<else/>
					<div class="jobsWrap">
						<div class="res_empty">
							 Dear HR，您还没有 Post position <br>
							 Want to find the right people quickly ，就赶紧 Post position 招揽人才吧~
						</div>
						<div class="res_empty_addbox">
							<div class="btn_blue J_hoverbut btn_115_38" onclick="window.location='{:U('jobs_add')}'"> Post position >></div>
						</div>
					</div>
				</notempty>
			</div>
			<div class="clear"></div>
		</div>
		<include file="index_footer" />
		<script type="text/javascript" src="../public/js/jquery.allselected.js"></script>
		<script type="text/javascript">
			$(document).ready(function(){
				$("#delete_all").click(function(){
					var listCheckedArray = $('.J_allListBox .J_allList:checked');
					if (!listCheckedArray.length) {
						disapperTooltip("remind",' Please choose a position ');
						return false;
					}
					var url = "{:U('jobs_delete')}";
		            var qsDialog = $(this).dialog({
		                title: ' delete 职位',
		                loading: true,
		                border: false,
		                yes: function () {
		                    $("#form1").attr('action',"{:U('jobs_delete')}");
							$("#form1").submit();
		                }
		            });
		            $.getJSON(url, function (result) {
		                if (result.status == 1) {
		                    qsDialog.setContent(result.data.html);
		                } else {
		                    disapperTooltip('remind', result.msg);
		                }
		            });
				});
				$(".close").click(function(){
					var url = $(this).attr('url');
		            var qsDialog = $(this).dialog({
		                title: ' shut down 职位',
		                loading: true,
		                border: false,
		                yes: function () {
		                    $.post(url, function (result) {
				                if (result.status == 1) {
				                	disapperTooltip("success",result.msg);
				                	setTimeout(function () {
				                        location.href=result.data;
				                    }, 2000);
				                } else {
				                    disapperTooltip('remind', result.msg);
				                }
				            },'json');
		                }
		            });
		            $.getJSON(url, function (result) {
		                if (result.status == 1) {
		                    qsDialog.setContent(result.data.html);
		                } else {
		                    disapperTooltip('remind', result.msg);
		                }
		            });
				});
				$(".delete").click(function(){
					var url = $(this).attr('url');
		            var qsDialog = $(this).dialog({
		                title: ' delete 职位',
		                loading: true,
		                border: false,
		                yes: function () {
		                    $.post(url, function (result) {
				                if (result.status == 1) {
				                	disapperTooltip("success",result.msg);
				                    setTimeout(function () {
				                        location.href=result.data;
				                    }, 2000);
				                } else {
				                    disapperTooltip('remind', result.msg);
				                }
				            },'json');
		                }
		            });
		            $.getJSON(url, function (result) {
		                if (result.status == 1) {
		                    qsDialog.setContent(result.data.html);
		                } else {
		                    disapperTooltip('remind', result.msg);
		                }
		            });
				});
				//  Share a circle of friends 
				$(".friend").click(function(){
					var qsDialog = $(this).dialog({
		        		loading: true,
						footer: false,
						header: false,
						border: false,
						backdrop: false
					});
					var url = $(this).attr('url');
					qsDialog.hide();
					var qsDialogSon = $(this).dialog({
		        		title: ' Share a circle of friends ',
		        		content: '<img width="200" height="200" src="{:C("qscms_site_dir")}index.php?m=Home&c=Qrcode&a=index&url='+url+'" />',
						footer: false
					});
				});
				$(".jobs_refresh").click(function(){
					var url = $(this).attr('url');
					var footerShow = eval($(this).data('type'));
					var qsDialog = $(this).dialog({
		        		title: '职位 Refresh ',
		        		loading:true,
						showFooter: false,
						yes:function(){
							$.post(url,function(result){
								if(result.status){
									disapperTooltip("success",result.msg);
                					setTimeout(function () {
				                        window.location.reload();
				                    }, 2000);
								}else{
					                disapperTooltip("remind",result.msg);
					                return false;
					            }
							},'json');
						}
					});
					$.getJSON(url,function(result){
						if(result.data.show_footer==0){
							qsDialog.showFooter(false);
						}else{
							if (!footerShow) {
								qsDialog.showFooter(true);
							}
						}
						qsDialog.setContent(result.msg);
					});
				});
				$(".stick_btn").click(function(){
					var qsDialog = $(this).dialog({
		        		title: ' Positions ',
		        		loading:true,
						showFooter: false
					});
					var url = "{:U('CompanyService/jobs_stick')}";
					var jobs_id = $(this).attr('data');
					$.getJSON(url,{jobs_id:jobs_id},function(result){
						qsDialog.setContent(result.msg);
					});
				});
				$(".emergency_btn").click(function(){
					var qsDialog = $(this).dialog({
		        		title: ' Job emergency ',
		        		loading:true,
						showFooter: false
					});
					var url = "{:U('CompanyService/jobs_emergency')}";
					var jobs_id = $(this).attr('data');
					$.getJSON(url,{jobs_id:jobs_id},function(result){
						qsDialog.setContent(result.msg);
					});
				});
				$(".jobs_display").click(function(){
					var url = $(this).attr('url');
		            var qsDialog = $(this).dialog({
		                title: ' restore 职位',
		                loading: true,
		                border: false,
		                yes: function () {
		                    $.post(url, function (result) {
				                if (result.status == 1) {
				                	disapperTooltip("success",result.msg);
				                    setTimeout(function () {
				                        location.href=result.data;
				                    }, 2000);
				                } else {
				                    disapperTooltip('remind', result.msg);
				                }
				            },'json');
		                }
		            });
		            $.getJSON(url, function (result) {
		                if (result.status == 1) {
		                    qsDialog.setContent(result.data.html);
		                } else {
		                    disapperTooltip('remind', result.msg);
		                }
		            });
				});
			});
		</script>
	</body>
</html>