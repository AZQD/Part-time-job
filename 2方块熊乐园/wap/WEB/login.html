<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登陆&注册</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
    <meta http-equiv="x-dns-prefetch-control" content="on" />
    <meta name="format-detection"content="telephone=no"/>
    <meta name="format-detection" content="email=no"/>
    <link rel="stylesheet" href="css/bootstraptc.min.css">
    <link rel="stylesheet" href="css/ppublic.min.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <style type="text/css">
        body{
            overflow: auto;
        }
        /*searchBox*/
        .searchBox .search{
            width:1200px;
            height:100px;
            line-height:100px;
            margin:0 auto;
            font-size: 14px;
            color: #666;
            background-color: #fff;
        }
        .searchBox .search .searchLeft .logo{
            padding-left:16px;
            width: 325px;
            height: 51px;
        }
        .searchBox .search .searchLeft .change{
            text-decoration: underline;
        }
        .searchBox .search .searchRight{
            text-align: right;
        }
        .searchBox .search .searchRight .ipt{
            width: 310px;
            height: 35px;
            line-height:35px;
            font-size: 13px;
            outline: none;
            text-indent: 10px;
            letter-spacing: 0;
            border: 1px solid #FF4720;
        }
        .searchBox .search .searchRight .searchImg{
            cursor: pointer;
            width:70px;
            margin-left:-6px;
        }
        .searchBox .search .searchRight .searchBtn{
            width: 127px;
            height: 35px;
            line-height:35px;
            color: #fff;
            font-size: 13px;
            border: none;
            outline: none;
            background-color: #FF4720;
            margin-right:42px;
        }

        /*login_registerBox*/
        .loginRegisterBox{
            margin-top: 100px;
        }
        .loginRegisterBox .loginRegister{
            width:1200px;
            margin:0 auto;
        }
        .loginRegisterBox .loginRegister .loginWrap{
            padding-bottom: 70px;
            border-right: 1px solid #999;
        }
        .loginRegisterBox .loginRegister .loginWrap .loginBox{
            width: 290px;
            margin:0 auto;
            /*background-color: #bfa;*/
        }
        .loginRegisterBox .loginRegister .loginWrap .loginBox .loginTitle{
            font-size: 18px;
            color: #333;
            font-weight:bold;
            margin:16px 0;
        }
        .loginRegisterBox .loginRegister .loginWrap .loginBox .loginTitle .gang{
            color: #FF4720;
            padding-left: 5px;
        }
        .loginRegisterBox .loginRegister .loginPhone{
            height: 42px;
            margin-bottom: 10px;
        }
        .loginRegisterBox .loginRegister .loginPhone .phoneImg{
            width: 42px;
            height: 42px;
        }
        .loginRegisterBox .loginRegister .loginPhone .phoneText{
            width: 248px;
            height:42px;
            line-height: 42px;
            outline: none;
            border: 1px solid #999;
            text-indent: 5px;
        }
        .loginRegisterBox .loginRegister .loginPassword{
            height: 42px;
            margin-bottom: 10px;
        }
        .loginRegisterBox .loginRegister .loginPassword .passwordImg{
            width: 42px;
            height: 42px;
        }
        .loginRegisterBox .loginRegister .loginPassword .passwordText{
            width: 248px;
            height:42px;
            line-height: 42px;
            outline: none;
            border: 1px solid #999;
            text-indent: 5px;
        }
        .loginRegisterBox .loginRegister .loginBtn{
            cursor: pointer;
            font-size: 13px;
            color: #fff;
            width:100%;
            height: 35px;
            line-height:35px;
            text-align: center;
            background-color: #FF4720;
        }
        .loginRegisterBox .loginRegister .loginBottom{
            padding-top: 10px;
        }
        .loginRegisterBox .loginRegister .loginBottom img{
            width: 25px;
            height: 25px;
        }

        .loginRegisterBox .loginRegister .registerWrap{
            padding-bottom: 70px;
        }
        .loginRegisterBox .loginRegister .registerWrap .registerBox{
            width: 290px;
            margin:0 auto;
            /*background-color: #bfa;*/
        }
        .loginRegisterBox .loginRegister .registerWrap .registerBox .registerTitle{
            font-size: 18px;
            color: #333;
            font-weight:bold;
            margin:16px 0;
        }
        .loginRegisterBox .loginRegister .registerWrap .registerBox .registerTitle .gang{
            color: #FF4720;
            padding-left: 5px;
        }
        .loginRegisterBox .loginRegister .registerPhone{
            height: 42px;
            margin-bottom: 10px;
        }
        .loginRegisterBox .loginRegister .registerPhone .phoneImg{
            width: 42px;
            height: 42px;
        }
        .loginRegisterBox .loginRegister .registerPhone .phoneText{
            width: 248px;
            height:42px;
            line-height: 42px;
            outline: none;
            border: 1px solid #999;
            text-indent: 5px;
        }
        .loginRegisterBox .loginRegister .registerPassword{
            height: 42px;
            margin-bottom: 10px;
        }
        .loginRegisterBox .loginRegister .registerPassword .passwordImg{
            width: 42px;
            height: 42px;
        }
        .loginRegisterBox .loginRegister .registerPassword .passwordText{
            width: 248px;
            height:42px;
            line-height: 42px;
            outline: none;
            border: 1px solid #999;
            text-indent: 5px;
        }
        .loginRegisterBox .loginRegister .registerDrag{
            position: relative;
            height:35px;
            line-height: 35px;
            outline: none;
            background-color: #ccc;
            text-align: center;
            margin-bottom: 16px;
        }
        .loginRegisterBox .loginRegister .registerDragNew{
            position: relative;
            height:35px;
            line-height: 35px;
            outline: none;
            background-color: #ccc;
            text-align: center;
            margin-bottom: 16px;
        }
        .loginRegisterBox .loginRegister .registerDrag .dragImg{
            position: absolute;
            left:0;
            top:-1px;
            width: 40px;
            height:37px;
        }
        .loginRegisterBox .loginRegister .registerBtn{
            cursor: pointer;
            font-size: 13px;
            color: #fff;
            width:100%;
            height: 35px;
            line-height:35px;
            text-align: center;
            background-color: #FF4720;
        }
        .loginRegisterBox .findPsw{
            padding-top: 80px;
            font-size: 14px;
            text-align: center;
        }
        .loginRegisterBox .findPsw a{
            color: #169BD5;
        }

        /*#drag*/
        #drag{
            position: relative;
            background-color: #e8e8e8;
            width: 290px;
            height: 34px;
            line-height: 34px;
            text-align: center;
        }
        #drag .handler{
            position: absolute;
            top: 0px;
            left: 0px;
            width: 40px;
            height: 35px;
            border: 1px solid #ccc;
            cursor: move;
        }
        .handler_bg{
            background: #fff url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0ZDhlNWY5My05NmI0LTRlNWQtOGFjYi03ZTY4OGYyMTU2ZTYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTEyNTVEMURGMkVFMTFFNEI5NDBCMjQ2M0ExMDQ1OUYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTEyNTVEMUNGMkVFMTFFNEI5NDBCMjQ2M0ExMDQ1OUYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2MTc5NzNmZS02OTQxLTQyOTYtYTIwNi02NDI2YTNkOWU5YmUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NGQ4ZTVmOTMtOTZiNC00ZTVkLThhY2ItN2U2ODhmMjE1NmU2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+YiRG4AAAALFJREFUeNpi/P//PwMlgImBQkA9A+bOnfsIiBOxKcInh+yCaCDuByoswaIOpxwjciACFegBqZ1AvBSIS5OTk/8TkmNEjwWgQiUgtQuIjwAxUF3yX3xyGIEIFLwHpKyAWB+I1xGSwxULIGf9A7mQkBwTlhBXAFLHgPgqEAcTkmNCU6AL9d8WII4HOvk3ITkWJAXWUMlOoGQHmsE45ViQ2KuBuASoYC4Wf+OUYxz6mQkgwAAN9mIrUReCXgAAAABJRU5ErkJggg==") no-repeat center;
        }
        .handler_ok_bg{
            background: #fff url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0ZDhlNWY5My05NmI0LTRlNWQtOGFjYi03ZTY4OGYyMTU2ZTYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDlBRDI3NjVGMkQ2MTFFNEI5NDBCMjQ2M0ExMDQ1OUYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDlBRDI3NjRGMkQ2MTFFNEI5NDBCMjQ2M0ExMDQ1OUYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDphNWEzMWNhMC1hYmViLTQxNWEtYTEwZS04Y2U5NzRlN2Q4YTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NGQ4ZTVmOTMtOTZiNC00ZTVkLThhY2ItN2U2ODhmMjE1NmU2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+k+sHwwAAASZJREFUeNpi/P//PwMyKD8uZw+kUoDYEYgloMIvgHg/EM/ptHx0EFk9I8wAoEZ+IDUPiIMY8IN1QJwENOgj3ACo5gNAbMBAHLgAxA4gQ5igAnNJ0MwAVTsX7IKyY7L2UNuJAf+AmAmJ78AEDTBiwGYg5gbifCSxFCZoaBMCy4A4GOjnH0D6DpK4IxNSVIHAfSDOAeLraJrjgJp/AwPbHMhejiQnwYRmUzNQ4VQgDQqXK0ia/0I17wJiPmQNTNBEAgMlQIWiQA2vgWw7QppBekGxsAjIiEUSBNnsBDWEAY9mEFgMMgBk00E0iZtA7AHEctDQ58MRuA6wlLgGFMoMpIG1QFeGwAIxGZo8GUhIysmwQGSAZgwHaEZhICIzOaBkJkqyM0CAAQDGx279Jf50AAAAAABJRU5ErkJggg==") no-repeat center;
        }
        #drag .drag_bg{
            background-color: #7ac23c;
            height: 34px;
            width: 0px;
        }
        #drag .drag_text{
            position: absolute;
            top: 0px;
            width: 300px;
            -moz-user-select: none;
            -webkit-user-select: none;
            user-select: none;
            -o-user-select:none;
            -ms-user-select:none;
        }
    </style>
</head>
<body>
<section class="container-fluid">

    <aside class="searchBox">
        <div class="row search">
            <div class="col-xs-6 col-sm-6 searchLeft">
                <img class="logo" src="image/index/logo.png">
            </div>
            <div class="col-xs-6 col-sm-6 searchRight">
                <input class="ipt" type="text" placeholder="What dou you need?">
                <img class="searchImg" src="image/index/search.png">
                <button class="searchBtn">PUBLISH</button>
            </div>
        </div>
    </aside>

    <aside class="row loginRegisterBox">
        <div class="row loginRegister">
            <div class="col-xs-6 col-sm-6 loginWrap">
                <div class="row loginBox">
                    <div class="col-xs-12 col-sm-12 loginTitle">
                        <span class="gang">|</span>&nbsp;<span class="">LOGIN</span>
                    </div>
                    <div class="col-xs-12 col-sm-12 loginPhone">
                        <img class="phoneImg" src="image/loginRegister/phoneImg.png"><input class="phoneText" id="loginPhone" type="text" placeholder="Cellphone Number">
                    </div>
                    <div class="col-xs-12 col-sm-12 loginPassword">
                        <img class="passwordImg" src="image/loginRegister/passwordImg.png"><input class="passwordText" id="loginPassword" type="text" placeholder="Password">
                    </div>
                    <div class="col-xs-12 col-sm-12 loginBtn" id="loginBtn">LOGIN</div>
                    <!--<div class="col-xs-12 col-sm-12 loginBottom">
                        <img class="passwordImg" src="image/loginRegister/login1.png">&nbsp;&nbsp;
                        <img class="passwordImg" src="image/loginRegister/login2.png">
                    </div>-->

                </div>
            </div>
            <div class="col-xs-6 col-sm-6 registerWrap">
                <div class="row registerBox">
                    <div class="col-xs-12 col-sm-12 registerTitle">
                        <span class="gang">|</span>&nbsp;<span class="">REGISTER</span>
                    </div>
                    <div class="col-xs-12 col-sm-12 registerPhone">
                        <img class="phoneImg" src="image/loginRegister/phoneImg.png"><input id="registerPhone" class="phoneText" type="text" placeholder="Cellphone Number">
                    </div>
                    <div class="col-xs-12 col-sm-12 registerPassword">
                        <img class="passwordImg" src="image/loginRegister/passwordImg.png"><input id="registerPassword" class="passwordText" type="text" placeholder="Password">
                    </div>
                    <!--<div class="col-xs-12 col-sm-12 registerDrag">
                        Drag Block To Right
                        <img class="dragImg" src="image/loginRegister/dragBlock.png">
                    </div>-->

                    <!--#darg-->
                    <div class="col-xs-12 col-sm-12 registerDragNew">
                        <div id="drag"></div>
                    </div>
                    <div class="col-xs-12 col-sm-12 registerBtn" id="registerBtn">REGISTER</div>

                </div>
            </div>
            <div class="col-xs-12 col-sm-12 findPsw"><a href="###">Forgot your password?</a></div>
        </div>
    </aside>
</section>
<script type="text/javascript" src="js/jquery-3.0.0.min.js"></script>
<script type="text/javascript" src="js/drag.js"></script>
<script type="text/javascript" src="js/swiper.min.js"></script>
<script type="text/javascript" src="js/base64.js"></script>
<script type="text/javascript" src="js/jsencrypt.js"></script>
<script type="text/javascript" src="js/public.js"></script>
<script type="text/javascript" src="js/searchBoxRight.js"></script>
<script type="text/javascript">
    $(function(){

        var b = new Base64_new();
        var publicKey = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5jmTSO5V9ILlphRYdfFk4M2Rko/Ur22h43SxkFcGcj9Vkuew5P65XJPQtJesvY37UmU7zXWsqT/i4Evo2gaYu9Eu/fgutkP9KE4yKh4Ruk/pYC+hyNFVIK21kl4o8cfV9cKumydj2WXgmuywX8UQiVIfbKuvEAw+RVvPjBt9UqQIDAQAB";
        var encrypt = new JSEncrypt();
        encrypt.setPublicKey(publicKey);

        //登陆
        $('#loginBtn').unbind('click').click(function () {
            var loginPhone = b.encode($.trim($('#loginPhone').val()));
            var loginPassword = b.encode($.trim($('#loginPassword').val()));
            var authKey = encrypt.encrypt("user="+ loginPhone +"&pass="+ loginPassword);//获取密钥
            var timestamp=new Date().getTime();//获取时间戳
//            console.log(loginPhone);
//            console.log(loginPassword);
//            console.log(authKey);
            var authInfo = {
                "auth":authKey,
                "timestamp":timestamp
            };
            $.ajax({
                type:"POST",
                url:baseUrl + "/apigateway/login",
                dataType:"json",
                data:JSON.stringify(authInfo),
                success:function(data){
                    if(data.status == 200){
                        data = JSON.parse(data.data);
                        console.log("登陆",data);
                        var token = data.token;
                        localStorage.setItem('token',token);//设置本地存储
//                        setCookie('token', token, 1);
//                        window.location.href = "index.html";
                        window.history.go(-1);
                    }else{
                        alert(data.msg);
                    }
                },
                error:function(error){
                    console.log(error);
                }
            });
        });


        //注册
        /*#drag*/
        $('.registerDragNew #drag').drag();
        var timer = setInterval(function(){
            if($('#drag .drag_text').text() == "OK"){
                clearInterval(timer);
            }
        }, 500);

        $('#registerBtn').unbind('click').click(function () {
            var dragText = $('#drag .drag_text').text();
            var registerPhone = b.encode($.trim($('#registerPhone').val()));
            var registerPassword = b.encode($.trim($('#registerPassword').val()));
            var reg = encrypt.encrypt("user="+ registerPhone +"&pass="+ registerPassword +"&nickname="+ registerPhone);//获取密钥
            var timestamp=new Date().getTime();//获取时间戳
//            console.log(registerPhone);
//            console.log(registerPassword);
//            console.log(reg);
            var authInfo = {
                "reg":reg,
                "timestamp":timestamp
            };
            if(dragText == 'OK'){
                $.ajax({
                    type:"POST",
                    url:baseUrl + "/apigateway/reg",
                    dataType:"json",
                    data:JSON.stringify(authInfo),
                    success:function(data){
//                        console.log(data);
//                        console.log(data.msg);
                        console.log("注册",data);
                        if(data.status == 200){
                            window.location.href = "index.html";
                        }else{
                            alert(data.msg);
                        }
                    },
                    error:function(error){
                        console.log(error);
                    }
                });
            }else{
                alert("请拖拽滑块~");
            }
        });
    });
</script>
</body>
</html>